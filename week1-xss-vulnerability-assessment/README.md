# Week 1 Security Assessment — NodeGoat

## Vulnerability 1: Stored Cross-Site Scripting (XSS)

### Description
The `First Name` field on the `/profile` page is vulnerable to Stored XSS.  
User input is not properly sanitized before being rendered in the HTML response.

### Steps to Reproduce
1. Log in to the NodeGoat application.
2. Go to **Profile** → Edit Profile.
3. In the **First Name** field, enter:
   ```html
   <script>alert('XSS');</script>
4. Click Submit.
5. When the page reloads, an alert box appears with the message XSS.  

### Evidence

1_XSS_Alert_Popup.png — shows alert execution.

2_XSS_ZAP_Response.png — shows payload in HTML.

### Impact

Attackers could inject malicious JavaScript, potentially stealing user sessions or redirecting users to malicious sites.

### Mitigation

1. Escape all user input before rendering (e.g., using res.render() with encoding).

2. Implement input validation and sanitization on both client and server side.

3. Use frameworks that auto-escape output (e.g., React, Angular).

4. Add a Content Security Policy (CSP).

### Tools Used

1. OWASP ZAP

2. NodeGoat vulnerable app

3. Firefox browser


---

### Vulnerability 2: Weak Password Transmission (Insecure Form Handling)

**Description:**  
The signup form at `/signup` transmits user passwords in plaintext within the HTTP request body.  
Although the site runs on `localhost`, such transmission without HTTPS exposes credentials to interception in real deployments.

**Steps to Reproduce:**
1. Launch the NodeGoat app and open `/signup`.  
2. Intercept traffic using OWASP ZAP.  
3. Observe the `POST /signup` request — the `password` field is visible in plaintext.  
4. Review the `Response` — the server does not echo the password, confirming transmission only but still insecure.

**Evidence:**  
- `3_signup_request.png` — shows password sent in plaintext via POST.  
- `4_signup_response.png` — shows response HTML (after submission).  

**Impact:**  
Credentials could be captured by a man-in-the-middle if the site is ever served over plain HTTP.  
Attackers could reuse stolen passwords elsewhere, compromising user accounts.

**Mitigation Recommendations:**
1. Enforce HTTPS (TLS) for all pages.  
2. Never transmit credentials over unencrypted channels.  
3. Implement strong password policies and hashing on the server side.  
4. Consider rate-limiting and 2-factor authentication for added security.  

---

---

### Vulnerability 3: Security Misconfigurations

**Description:**  
During the OWASP ZAP Active Scan, several misconfiguration issues were discovered, including:  
- Missing or weak Content Security Policy (CSP)  
- Absence of Anti-CSRF tokens on forms  
- Server header exposing framework (Express) and technology details  
These indicate improper hardening of the web application server and HTTP security headers.

**Steps to Reproduce:**  
1. Run the OWASP ZAP Spider and Active Scan on `http://localhost:4000`  
2. Open the **Alerts** tab in ZAP to review the results  
3. Misconfigurations were identified under “Absence of Anti-CSRF Tokens” and “CSP Failure to Define Directive with No Fallback”

**Evidence:**  
- `5_Security_Misconfiguration.png` — shows alert findings from ZAP  

**Impact:**  
Attackers can exploit these misconfigurations to launch CSRF, clickjacking, or information disclosure attacks.  

**Mitigation:**  
- Implement strict Content Security Policy (CSP)  
- Add CSRF tokens to all forms  
- Disable unnecessary server headers (e.g., `X-Powered-By`)  
- Apply security headers such as HSTS and X-Frame-Options  
